#N canvas 231 49 757 558 10;
#X obj 21 46 bng 50 250 50 0 empty empty load 8 25 0 12 -203904 -262144
-1;
#N canvas 734 35 335 570 IRmonitor 0;
#X obj 30 233 t f f;
#X obj 30 517 tabwrite \$0-IRmonitor;
#X obj 30 312 +;
#X obj 30 369 tabread4 \$0-impulse-response;
#X obj 43 172 - 1;
#X floatatom 44 111 8 0 0 0 - - -;
#N canvas 709 116 378 407 vzoom 0;
#X obj 42 18 r \$0-log-vzoom;
#X obj 42 143 t b f;
#X obj 42 198 pow;
#X floatatom 92 227 8 0 0 0 - - -;
#X obj 258 215 makesymbol;
#X obj 258 272 s \$0-vzoom-label;
#X obj 42 68 5;
#X obj 42 42 t b f;
#X obj 42 94 -;
#X obj 42 118 abs;
#X obj 203 340 s \$0-vplus;
#X obj 170 372 s \$0-vminus;
#X obj 203 263 1;
#X obj 203 238 t b f;
#X obj 203 290 /;
#X floatatom 213 316 8 0 0 0 - - -;
#X obj 170 339 * -1;
#X obj 69 254 s \$0-zoomfactor;
#X obj 42 227 t b f;
#X msg 258 241 label \$1x;
#X obj 42 171 5;
#X obj 42 282 s \$0-refresh-monitor;
#X connect 0 0 7 0;
#X connect 1 0 20 0;
#X connect 1 1 2 1;
#X connect 2 0 3 0;
#X connect 2 0 4 0;
#X connect 2 0 13 0;
#X connect 2 0 18 0;
#X connect 4 0 19 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 7 1 8 1;
#X connect 8 0 9 0;
#X connect 9 0 1 0;
#X connect 12 0 14 0;
#X connect 13 0 12 0;
#X connect 13 1 14 1;
#X connect 14 0 15 0;
#X connect 14 0 10 0;
#X connect 14 0 16 0;
#X connect 16 0 11 0;
#X connect 18 0 21 0;
#X connect 18 1 17 0;
#X connect 19 0 5 0;
#X connect 20 0 2 0;
#X restore 214 24 pd vzoom;
#N canvas 0 22 256 299 hzoom 0;
#X obj 35 118 pow;
#X obj 35 70 t b f;
#X obj 35 95 f 2;
#X obj 35 47 + 5;
#X floatatom 53 143 8 0 0 0 - - -;
#X obj 35 253 s \$0-IRmonitor-size-label;
#X obj 35 196 makesymbol;
#X obj 35 16 r \$0-log-IRmonitor-size;
#X obj 45 170 s \$0-IRmonitor-size;
#X msg 35 224 label hzoom:\$1samples;
#X connect 0 0 4 0;
#X connect 0 0 6 0;
#X connect 0 0 8 0;
#X connect 1 0 2 0;
#X connect 1 1 0 1;
#X connect 2 0 0 0;
#X connect 3 0 1 0;
#X connect 6 0 9 0;
#X connect 7 0 3 0;
#X connect 9 0 5 0;
#X restore 214 -3 pd hzoom;
#X obj 30 -9 r \$0-IRmonitor-size;
#X obj 30 491 clip -1 1;
#X obj 30 462 * 1;
#X obj 45 437 r \$0-zoomfactor;
#X floatatom 59 462 8 0 0 0 - - -;
#X obj 30 85 f;
#X obj 175 472 table \$0-trimmed-IR;
#X obj 171 517 tabwrite \$0-trimmed-IR;
#X obj 30 196 for++;
#X obj 44 49 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 57 313 8 0 0 0 - - -;
#N canvas 312 88 395 490 offset 0;
#X obj 25 0 inlet;
#X obj 25 456 outlet;
#X obj 91 325 +;
#X floatatom 91 353 5 0 0 0 - - -;
#X obj 25 410 +;
#X obj 91 457 s \$0-shift-IRmonitor;
#X msg 148 336 0;
#X text 180 335 reset;
#X obj 148 312 r \$0-IRloaded;
#X obj 91 379 t f b f;
#X obj 64 -1 r \$0-position-slider;
#X floatatom 76 26 5 0 0 0 - - -;
#X obj 79 70 r \$0-IRmonitor-size;
#X floatatom 99 273 5 0 0 0 - - -;
#X obj 64 101 *;
#X obj 64 48 / 512;
#X obj 64 151 int;
#X obj 92 101 / 2;
#X obj 64 127 -;
#X msg 136 223 0;
#X obj 64 180 t b f;
#X msg 168 223 1;
#X obj 168 197 delay 200;
#X obj 91 250 spigot 1;
#N canvas 0 22 192 178 inc-dec 0;
#X obj 39 22 r \$0-inc;
#X obj 99 21 r \$0-dec;
#X obj 49 44 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 109 48 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 39 106 f;
#X obj 39 136 outlet;
#X msg 99 75 -1;
#X msg 39 75 1;
#X connect 0 0 2 0;
#X connect 0 0 7 0;
#X connect 1 0 3 0;
#X connect 1 0 6 0;
#X connect 4 0 5 0;
#X connect 6 0 4 0;
#X connect 7 0 4 0;
#X restore 75 294 pd inc-dec;
#X obj 215 49 s \$0-position-slider-receive;
#X text 288 25 reset slider;
#X msg 215 26 set 256.01;
#X obj 215 2 r \$0-IRmonitor-done;
#X obj 104 432 s \$0-refresh-monitor;
#X obj 104 408 bang;
#X connect 0 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 2 1;
#X connect 3 0 9 0;
#X connect 4 0 1 0;
#X connect 6 0 3 0;
#X connect 8 0 6 0;
#X connect 9 0 5 0;
#X connect 9 0 30 0;
#X connect 9 1 4 0;
#X connect 9 2 4 1;
#X connect 10 0 11 0;
#X connect 10 0 15 0;
#X connect 12 0 14 1;
#X connect 12 0 17 0;
#X connect 14 0 18 0;
#X connect 15 0 14 0;
#X connect 16 0 20 0;
#X connect 17 0 18 1;
#X connect 18 0 16 0;
#X connect 19 0 23 1;
#X connect 20 0 19 0;
#X connect 20 0 22 0;
#X connect 20 1 23 0;
#X connect 21 0 23 1;
#X connect 22 0 21 0;
#X connect 23 0 2 0;
#X connect 23 0 13 0;
#X connect 24 0 2 0;
#X connect 27 0 25 0;
#X connect 28 0 27 0;
#X connect 30 0 29 0;
#X restore 45 284 pd offset;
#X obj 220 110 bng 30 250 50 0 \$0-viewlist-trimmed-IR empty empty
17 7 0 10 -203904 -260097 -1;
#X text 222 86 list;
#X obj 30 340 split 0 1;
#X obj 30 409 f;
#X msg 81 392 0;
#X obj 136 323 r \$0-IRsize;
#X floatatom 136 347 8 0 0 0 - - -;
#X obj 44 17 r \$0-refresh-monitor;
#X obj 81 213 s \$0-IRmonitor-done;
#N canvas 0 22 226 239 monitor-section 0;
#X obj 22 34 inlet;
#X obj 22 195 outlet;
#X floatatom 34 164 8 0 0 0 - - -;
#X obj 22 122 +;
#X floatatom 91 134 8 0 0 0 - - -;
#X floatatom 33 95 5 0 0 0 - - -;
#X obj 22 68 / -2;
#X obj 91 105 / 2;
#X obj 91 76 r \$0-IRsize;
#X connect 0 0 6 0;
#X connect 3 0 2 0;
#X connect 3 0 1 0;
#X connect 6 0 3 0;
#X connect 6 0 5 0;
#X connect 7 0 4 0;
#X connect 7 0 3 1;
#X connect 8 0 7 0;
#X restore 45 261 pd monitor-section;
#N canvas 0 22 272 286 array-messages 0;
#X obj 51 38 inlet;
#X obj 51 242 s \$0-IRmonitor;
#X msg 51 129 resize \$1;
#X msg 89 185 arrayviewlistnew;
#X obj 73 219 s \$0-trimmed-IR;
#X obj 89 157 r \$0-viewlist-trimmed-IR;
#X msg 73 98 arrayviewclose;
#X obj 51 70 t f b;
#X connect 0 0 7 0;
#X connect 2 0 1 0;
#X connect 2 0 4 0;
#X connect 3 0 4 0;
#X connect 5 0 3 0;
#X connect 6 0 4 0;
#X connect 6 0 1 0;
#X connect 7 0 2 0;
#X connect 7 1 6 0;
#X restore 69 172 pd array-messages;
#X obj 30 133 t b f f;
#X text 112 393 write zero's outside IR range;
#X connect 0 0 2 0;
#X connect 0 1 1 1;
#X connect 0 1 15 1;
#X connect 2 0 22 0;
#X connect 3 0 23 0;
#X connect 4 0 16 1;
#X connect 8 0 13 0;
#X connect 9 0 1 0;
#X connect 10 0 9 0;
#X connect 11 0 10 1;
#X connect 11 0 12 0;
#X connect 13 0 31 0;
#X connect 13 0 5 0;
#X connect 16 0 0 0;
#X connect 16 1 28 0;
#X connect 17 0 13 0;
#X connect 19 0 2 1;
#X connect 19 0 18 0;
#X connect 22 0 3 0;
#X connect 22 1 24 0;
#X connect 23 0 10 0;
#X connect 23 0 15 0;
#X connect 24 0 23 0;
#X connect 25 0 22 2;
#X connect 25 0 26 0;
#X connect 27 0 17 0;
#X connect 29 0 19 0;
#X connect 31 0 16 0;
#X connect 31 1 29 0;
#X connect 31 1 4 0;
#X connect 31 2 30 0;
#X restore 661 342 pd IRmonitor;
#X obj 22 510 hradio 30 1 1 15 \$0-log-IRmonitor-size \$0-IRmonitor-size-label
hzoom:65536samples 0 -10 0 10 -203904 -260097 -1 11;
#X obj 558 249 vradio 30 1 1 6 \$0-log-vzoom \$0-vzoom-label 625x 0
-8 0 10 -203904 -260097 -1 1;
#X text 555 214 vzoom:;
#X floatatom 82 70 8 0 0 0 - #0-IRsize -;
#X symbolatom 82 46 30 0 0 0 - #0-IRname -;
#X obj 244 468 bng 30 250 50 0 \$0-dec empty < 7 15 1 25 -203904 -260097
-1;
#X obj 283 468 bng 30 250 50 0 \$0-inc empty > 9 15 1 25 -203904 -260097
-1;
#X obj 661 189 bng 50 250 50 0 \$0-compute-spectrum empty spectrum
2 25 0 12 -203904 -262144 -1;
#X obj 660 48 bng 50 250 50 0 empty empty save 10 25 0 12 -203904 -262144
-1;
#N canvas 230 204 711 540 spectrum 0;
#X obj 561 443 inlet;
#N canvas 591 114 563 537 compute-spectral-data 0;
#X obj 131 113 switch~;
#X msg 131 87 set \$1;
#X obj 40 142 tabplay~ \$0-trimmed-IR;
#X obj 20 266 tabwrite~ \$0-IR-magnitude-spectrum;
#N canvas 27 408 454 232 phase 0;
#X obj 27 15 inlet~;
#X obj 78 16 inlet~;
#X obj 78 148 atan2~;
#X obj 78 187 outlet~;
#X obj 126 54 count~;
#X obj 175 15 r \$0-IRmonitor-size;
#X obj 126 16 inlet;
#X floatatom 175 55 8 0 0 0 - - -;
#X obj 78 117 *~;
#X obj 111 117 *~;
#X obj 303 52 r \$0-phase-alternator;
#X obj 126 79 expr~ if($f2 \, pow(-1 \, $v1) \, 1);
#X floatatom 319 80 5 0 0 0 - - -;
#X connect 0 0 9 0;
#X connect 1 0 8 0;
#X connect 2 0 3 0;
#X connect 4 0 11 0;
#X connect 5 0 7 0;
#X connect 5 0 4 1;
#X connect 6 0 4 0;
#X connect 8 0 2 0;
#X connect 9 0 2 1;
#X connect 10 0 11 1;
#X connect 10 0 12 0;
#X connect 11 0 8 1;
#X connect 11 0 9 1;
#X restore 104 204 pd phase;
#X obj 104 234 tabwrite~ \$0-IR-phase-spectrum;
#X obj 131 31 r \$0-IRmonitor-size;
#X obj 323 344 r \$0-IRmonitor-size;
#X obj 337 473 s \$0-IR-magnitude-spectrum;
#X obj 323 500 s \$0-IR-phase-spectrum;
#X obj 169 174 s \$0-spectrum-done;
#X floatatom 362 370 8 0 0 0 - - -;
#X msg 323 418 arrayviewclose \, resize \$1;
#N canvas 0 22 228 202 pyth~ 0;
#X obj 35 25 inlet~;
#X obj 98 25 inlet~;
#X obj 35 69 *~;
#X obj 98 69 *~;
#X obj 35 129 sqrt~;
#X obj 35 100 +~;
#X obj 35 163 outlet~;
#X connect 0 0 2 0;
#X connect 0 0 2 1;
#X connect 1 0 3 0;
#X connect 1 0 3 1;
#X connect 2 0 5 0;
#X connect 3 0 5 1;
#X connect 4 0 6 0;
#X connect 5 0 4 0;
#X restore 40 233 pd pyth~;
#X obj 63 8 r \$0-phase-alternator;
#X obj 20 75 bang;
#X obj 20 8 inlet;
#X obj 63 31 delay 20;
#X obj 323 371 / 2;
#X obj 40 173 rfft~;
#X obj 347 447 s \$0-deciBels;
#X obj 323 96 for++;
#X obj 336 39 r \$0-IRmonitor-size;
#X obj 336 65 / 2;
#X obj 393 77 r \$0-log-IRmonitor-size;
#X obj 393 103 + 4;
#X floatatom 378 157 5 0 0 0 - - -;
#X obj 378 133 /;
#X obj 323 150 /;
#X obj 323 12 r \$0-spectrum-done;
#X msg 323 202 2;
#X obj 323 177 t b f;
#X obj 323 232 pow;
#X obj 323 124 t f f;
#X obj 323 282 rmstodb;
#X obj 323 258 tabread \$0-IR-magnitude-spectrum;
#X obj 323 310 tabwrite \$0-deciBels;
#X obj 20 325 samplerate~;
#X obj 20 300 loadbang;
#X obj 20 462 /;
#X obj 35 411 r \$0-IRmonitor-size;
#X obj 20 488 s \$0-FFT-fundamental;
#X obj 34 357 / 2;
#X obj 34 384 s \$0-nyquist;
#X obj 78 301 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 35 436 t b f;
#X obj 131 58 split 32 131072;
#X obj 323 395 + 1;
#X connect 1 0 0 0;
#X connect 2 0 19 0;
#X connect 2 1 10 0;
#X connect 4 0 5 0;
#X connect 6 0 46 0;
#X connect 7 0 11 0;
#X connect 7 0 18 0;
#X connect 12 0 8 0;
#X connect 12 0 9 0;
#X connect 12 0 20 0;
#X connect 13 0 3 0;
#X connect 14 0 17 0;
#X connect 15 0 0 0;
#X connect 15 0 2 0;
#X connect 15 0 3 0;
#X connect 15 0 5 0;
#X connect 15 0 4 2;
#X connect 16 0 15 0;
#X connect 17 0 15 0;
#X connect 18 0 47 0;
#X connect 19 0 4 0;
#X connect 19 0 13 0;
#X connect 19 1 4 1;
#X connect 19 1 13 1;
#X connect 21 0 33 0;
#X connect 22 0 23 0;
#X connect 23 0 21 1;
#X connect 23 0 27 0;
#X connect 24 0 25 0;
#X connect 25 0 27 1;
#X connect 27 0 26 0;
#X connect 27 0 28 1;
#X connect 28 0 31 0;
#X connect 29 0 21 0;
#X connect 30 0 32 0;
#X connect 31 0 30 0;
#X connect 31 1 32 1;
#X connect 32 0 35 0;
#X connect 33 0 28 0;
#X connect 33 1 36 1;
#X connect 34 0 36 0;
#X connect 35 0 34 0;
#X connect 37 0 39 0;
#X connect 37 0 42 0;
#X connect 38 0 37 0;
#X connect 39 0 41 0;
#X connect 40 0 45 0;
#X connect 42 0 43 0;
#X connect 44 0 37 0;
#X connect 45 0 39 0;
#X connect 45 1 39 1;
#X connect 46 0 1 0;
#X connect 47 0 12 0;
#X restore 48 77 pd compute-spectral-data;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-IR-phase-spectrum 32769 float 0;
#X coords 0 3.17 32768 -3.17 290 140 1;
#X restore 48 372 graph;
#X text 23 214 1;
#X text 22 432 0;
#X text 104 29 (re)compute spectral data;
#X text 353 30 view lists;
#X obj 49 222 cnv 15 620 94 empty empty empty 20 12 0 14 -233017 -66577
0;
#X text 24 305 0;
#X text 20 365 pi;
#X text 19 499 -pi;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-IR-magnitude-spectrum 32769 float 2;
#X coords 0 1.5 32769 0 290 140 1;
#X restore 49 176 graph;
#X obj 48 16 bng 50 250 50 0 empty \$0-compute-spectrum 1 17 25 0 25
-203904 -262144 -1;
#X obj 292 16 bng 50 250 50 0 empty empty 2 17 25 0 25 -203904 -262144
-1;
#X symbolatom 48 108 30 0 0 0 - #0-IRname -;
#X msg 561 466 \; pd-spectrum vis 1;
#X obj 379 435 s \$0-phase-alternator;
#X obj 379 372 tgl 50 1 empty empty empty 17 7 0 10 -203904 -1 -1 1
1;
#X text 439 387 alternate phases;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-deciBels 32769 float 2;
#X coords 0 150 32769 0 290 140 1;
#X restore 379 176 graph;
#X text 681 215 0;
#X text 672 306 -100;
#N canvas 0 22 251 154 lists 0;
#X obj 27 93 s \$0-IR-magnitude-spectrum;
#X obj 36 65 s \$0-IR-phase-spectrum;
#X msg 27 40 arrayviewlistnew;
#X obj 27 15 inlet;
#X connect 2 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X restore 292 76 pd lists;
#X floatatom 637 324 5 0 0 0 - #0-nyquist -;
#X floatatom 308 324 5 0 0 0 - #0-nyquist -;
#X floatatom 379 324 5 0 0 0 - #0-FFT-fundamental -;
#X floatatom 49 323 5 0 0 0 - - -;
#X text 171 322 Hz \, linear;
#X text 483 323 Hz \, log;
#X text 14 400 rad.;
#X text 679 253 dB;
#X obj 497 15 bng 50 250 50 0 empty empty 3 17 25 0 25 -203904 -262144
-1;
#N canvas 752 38 455 253 magnitude-peak 0;
#X obj 30 26 inlet;
#X obj 30 55 tabminmax \$0-IR-magnitude-spectrum;
#X obj 231 82 unpack;
#X obj 231 199 outlet;
#X obj 294 56 samplerate~;
#X obj 279 199 outlet;
#X obj 294 30 loadbang;
#X obj 308 85 r \$0-IRmonitor-size;
#X obj 294 142 /;
#X obj 308 116 t b f;
#X obj 279 172 *;
#X obj 351 31 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 242 117 8 0 0 0 - - -;
#X connect 0 0 1 0;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 2 1 10 0;
#X connect 2 1 12 0;
#X connect 4 0 8 0;
#X connect 6 0 4 0;
#X connect 7 0 9 0;
#X connect 8 0 10 1;
#X connect 9 0 8 0;
#X connect 9 1 8 1;
#X connect 10 0 5 0;
#X connect 11 0 4 0;
#X restore 497 74 pd magnitude-peak;
#X floatatom 497 99 8 0 0 0 - - -;
#X floatatom 596 99 8 0 0 0 - - -;
#X text 593 117 frequency;
#X text 556 29 magnitude peak;
#X text 496 117 magnitude;
#X text 16 257 magn.;
#X connect 0 0 15 0;
#X connect 12 0 1 0;
#X connect 13 0 22 0;
#X connect 17 0 16 0;
#X connect 31 0 32 0;
#X connect 32 0 33 0;
#X connect 32 1 34 0;
#X restore 661 246 pd spectrum;
#N canvas 569 29 402 554 info/help 0;
#X text 14 42 1;
#X text 14 88 2;
#X text 10 304 3;
#X obj 201 573 pddplink www.katjaas.nl;
#X text 32 43 Load an impulse response which was created with the patch
IRrecorder and stored as 32 bit .wav file.;
#X text 32 16 This is a Pure Data patch for editing raw impulse responses.
;
#X text 30 88 The impulse response is shown in the graph IRmonitor
\, for which you can set horizontal and vertical zoom factors. Set
cuepoints for start point x[0] and stop point x[N]. When you click
a cuepoint button \, the index number at the location of the vertical
axis in the monitor center is stored as the cuepoint. When you click
at a location in the monitor \, that location is moved to the monitor
center. The horizontal zoom to 32 samples helps in sample-precise cuepoint-setting.
The left/right arrows do a one-sample shift.;
#X text 30 574 Katja Vetter april 2011;
#X text 31 227 The numbox below the trim-button shows the x[N]-x[0]
size. After trimming \, the IR-buffer is reduced to that size \, so
[N-1] is the last sample in the IR. You can still look at indexes beyond
the trimmed size \, but you will notice they have value zero.;
#X text 31 305 Set parameters for an optional window to be applied
to the trimmed IR. Recall that windowing does amplitude modulation
\, and is equivalent to low-pass filtering of the spectrum. If the
IR is made for analysis purposes only \, windowing is better avoided.
If the IR is intended as convolution filter \, windowing is probably
inevitable.;
#X text 12 397 4;
#X text 31 398 Normalisation of the spectrum magnitude peaks may be
done on the trimmed-and-windowed IR. Normalisation is done in such
a way that a sine of any frequency may be convolved with the IR \,
without exceeding the unity level (-1 to 1 in 32 bit floating point
values). Notice that such normalisation may produce a filter which
substantially reduces the RMS of the input signal.;
#X text 30 504 You can check the IR's spectral data \, which are computed
for the segment selected in the IR monitor.;
#X text 86 600 ______________________________________;
#X restore 661 312 pd info/help;
#X obj 18 137 cnv 15 15 15 empty empty IReditor 2 14 0 25 -262144 -66577
0;
#N canvas 636 210 321 293 save-IR 0;
#X obj 32 37 inlet;
#X obj 32 202 soundfiler;
#X obj 77 120 f \$0;
#X obj 77 95 loadbang;
#X floatatom 52 231 8 0 0 0 - - -;
#X obj 57 95 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 32 145 pack s f;
#X floatatom 90 146 5 0 0 0 - - -;
#X msg 32 177 write -wave -bytes 4 \$1 \$2-impulse-response;
#X obj 32 262 outlet;
#N canvas 635 142 170 214 savepanel 0;
#X obj 25 18 inlet;
#X obj 25 45 ggee/getdir;
#X obj 25 73 hcs/split_path;
#X obj 25 174 outlet;
#X obj 25 110 savepanel;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 4 0 3 0;
#X restore 32 65 pd savepanel;
#X connect 0 0 10 0;
#X connect 1 0 4 0;
#X connect 1 0 9 0;
#X connect 2 0 6 1;
#X connect 2 0 7 0;
#X connect 3 0 2 0;
#X connect 5 0 2 0;
#X connect 6 0 8 0;
#X connect 8 0 1 0;
#X connect 10 0 6 0;
#X restore 660 106 pd save-IR;
#X obj 555 450 nbx 8 18 -1e+37 1e+37 0 0 empty \$0-vminus --- -20 18
0 10 -228856 -1 -1 -0.0016 256;
#X obj 554 188 nbx 8 18 -1e+37 1e+37 0 0 empty \$0-vplus --- -20 0
0 10 -228856 -1 -1 0.0016 256;
#N canvas 577 268 532 424 load-IR 0;
#X obj 22 25 inlet;
#X obj 22 245 soundfiler;
#X obj 67 163 f \$0;
#X obj 67 137 loadbang;
#X floatatom 38 270 8 0 0 0 - - -;
#X obj 22 188 pack s f;
#X floatatom 80 189 5 0 0 0 - - -;
#X obj 22 400 outlet;
#X msg 22 219 read -resize \$1 \$2-impulse-response;
#X obj 72 324 s \$0-IRsize;
#X obj 269 178 tabminmax \$0-impulse-response;
#X floatatom 440 249 5 0 0 0 - - -;
#X obj 269 157 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X floatatom 269 202 5 0 0 0 - - -;
#X obj 440 206 unpack;
#X floatatom 473 231 8 0 0 0 - - -;
#X obj 33 376 s \$0-IRloaded;
#X obj 381 20 loadbang;
#X msg 381 47 \; pd dsp 1;
#X symbolatom 36 107 60 0 0 0 - - -;
#X obj 133 81 symbol;
#X obj 133 26 inlet;
#X text 174 27 reload last IR;
#X text 60 25 load IR;
#N canvas 0 22 343 213 default-cuepoints 0;
#X obj 27 29 inlet;
#X obj 45 69 >> 1;
#X text 132 136 set cuepoints to default values;
#X obj 45 95 s \$0-set-time-zero;
#X obj 27 144 s \$0-set-time-N;
#X connect 0 0 1 0;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X restore 52 349 pd default-cuepoints;
#X obj 33 295 t b f f;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-impulse-response 9706 float 2;
#X coords 0 1 9706 -1 113 50 1;
#X restore 220 345 graph;
#N canvas 635 142 255 227 openpanel 0;
#X obj 25 18 inlet;
#X obj 25 45 ggee/getdir;
#X obj 25 73 hcs/split_path;
#X obj 55 141 hcs/split_path;
#X obj 25 110 openpanel;
#X obj 25 174 outlet;
#X msg 165 72 -;
#X obj 165 43 loadbang;
#X obj 165 104 symbol;
#X obj 136 171 s \$0-IRname;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 1 9 0;
#X connect 4 0 3 0;
#X connect 4 0 5 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X restore 22 55 pd openpanel;
#X connect 0 0 27 0;
#X connect 1 0 4 0;
#X connect 1 0 7 0;
#X connect 1 0 25 0;
#X connect 2 0 5 1;
#X connect 2 0 6 0;
#X connect 3 0 2 0;
#X connect 5 0 8 0;
#X connect 8 0 1 0;
#X connect 10 0 13 0;
#X connect 10 1 14 0;
#X connect 12 0 10 0;
#X connect 14 0 11 0;
#X connect 14 1 15 0;
#X connect 17 0 18 0;
#X connect 20 0 5 0;
#X connect 21 0 20 0;
#X connect 25 0 16 0;
#X connect 25 1 24 0;
#X connect 25 2 9 0;
#X connect 27 0 20 1;
#X connect 27 0 5 0;
#X connect 27 0 19 0;
#X restore 21 105 pd load-IR;
#X floatatom 277 106 8 0 0 0 - #0-cuepoint-zero -;
#X text 135 70 samples;
#X obj 337 47 bng 50 250 50 0 \$0-set-time-N empty x[N] 6 25 0 16 -203904
-262144 -1;
#X obj 277 47 bng 50 250 50 0 \$0-set-time-zero empty x[0] 6 25 0 16
-203904 -262144 -1;
#X floatatom 337 106 8 0 0 0 - #0-cuepoint-N -;
#X obj 25 188 hsl 507 280 0 512 0 0 \$0-position-slider \$0-position-slider-receive
empty -2 -8 0 10 -262144 -260097 -1 25301 0;
#X obj 17 327 cnv 3 520 2 empty empty empty 20 12 0 14 -233017 -66577
0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-IRmonitor 65536 float 2;
#X coords 0 1 65536 -1 512 280 1;
#X restore 22 188 graph;
#N canvas 250 390 691 358 cuepoints 0;
#X floatatom 52 103 8 0 0 0 - - -;
#X floatatom 32 54 8 0 0 0 - - -;
#N canvas 894 230 247 307 set-cuepoint-zero 0;
#X obj 39 4 r \$0-set-time-zero;
#X obj 39 171 f;
#X obj 69 61 r \$0-IRsize;
#X obj 54 30 r \$0-shift-IRmonitor;
#X obj 54 140 +;
#X floatatom 80 86 8 0 0 0 - - -;
#X floatatom 67 172 8 0 0 0 - - -;
#X floatatom 84 138 8 0 0 0 - - -;
#X obj 69 109 >> 1;
#X obj 39 266 outlet;
#X obj 55 239 s \$0-cuepoint-zero;
#X obj 39 212 max 0;
#X text 75 211 negative index not allowed;
#X connect 0 0 1 0;
#X connect 1 0 11 0;
#X connect 2 0 5 0;
#X connect 2 0 8 0;
#X connect 3 0 4 0;
#X connect 4 0 1 1;
#X connect 4 0 6 0;
#X connect 8 0 4 1;
#X connect 8 0 7 0;
#X connect 11 0 9 0;
#X connect 11 0 10 0;
#X restore 40 77 pd set-cuepoint-zero;
#N canvas 634 471 229 264 set-cuepoint-N 0;
#X obj 39 171 f;
#X obj 69 61 r \$0-IRsize;
#X obj 54 30 r \$0-shift-IRmonitor;
#X obj 54 140 +;
#X floatatom 80 86 8 0 0 0 - - -;
#X floatatom 67 172 8 0 0 0 - - -;
#X floatatom 84 138 8 0 0 0 - - -;
#X obj 69 109 >> 1;
#X obj 39 230 outlet;
#X obj 39 4 r \$0-set-time-N;
#X obj 52 202 s \$0-cuepoint-N;
#X connect 0 0 8 0;
#X connect 0 0 10 0;
#X connect 1 0 4 0;
#X connect 1 0 7 0;
#X connect 2 0 3 0;
#X connect 3 0 0 1;
#X connect 3 0 5 0;
#X connect 7 0 3 1;
#X connect 7 0 6 0;
#X connect 9 0 0 0;
#X restore 22 25 pd set-cuepoint-N;
#X obj 22 162 -;
#X obj 40 125 t b f;
#X floatatom 39 189 8 0 0 0 - - -;
#N canvas 854 307 267 374 monitor-center 0;
#X obj 38 40 r \$0-IRsize;
#X obj 23 9 r \$0-shift-IRmonitor;
#X obj 23 119 +;
#X floatatom 49 65 8 0 0 0 - - -;
#X floatatom 49 149 8 0 0 0 - - -;
#X floatatom 53 117 8 0 0 0 - - -;
#X obj 38 88 >> 1;
#X obj 23 342 outlet;
#X obj 77 227 tabread \$0-impulse-response;
#X floatatom 99 304 8 0 0 0 - - -;
#X text 104 151 index;
#X text 151 304 value;
#X obj 49 176 s \$0-index;
#X obj 77 326 s \$0-value;
#X obj 77 202 split 0 1;
#X obj 128 177 r \$0-IRsize;
#X floatatom 139 203 8 0 0 0 - - -;
#X obj 77 280 f;
#X msg 128 253 0;
#X connect 0 0 3 0;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 2 0 7 0;
#X connect 2 0 14 0;
#X connect 2 0 12 0;
#X connect 6 0 2 1;
#X connect 6 0 5 0;
#X connect 8 0 17 0;
#X connect 14 0 8 0;
#X connect 14 1 18 0;
#X connect 15 0 16 0;
#X connect 15 0 14 2;
#X connect 17 0 9 0;
#X connect 17 0 13 0;
#X connect 18 0 17 0;
#X restore 22 278 pd monitor-center;
#X floatatom 22 303 8 0 0 0 - - -;
#X obj 202 106 for++;
#X obj 215 83 - 1;
#X obj 37 213 s \$0-trimmed-size;
#X obj 215 57 r \$0-trimmed-size;
#X obj 202 301 tabread \$0-impulse-response;
#X obj 202 201 t f f;
#X obj 202 329 tabwrite \$0-impulse-response;
#X obj 202 273 +;
#X obj 217 249 r \$0-cuepoint-zero;
#X obj 277 150 r \$0-trimmed-size;
#X msg 262 196 resize \$1;
#X obj 262 175 f;
#X obj 262 220 s \$0-impulse-response;
#X obj 336 192 s \$0-IRsize;
#X obj 438 281 s \$0-IRloaded;
#X obj 413 192 s \$0-set-time-N;
#X obj 412 150 s \$0-set-time-zero;
#X msg 412 123 0;
#X obj 438 254 delay 50;
#N canvas 390 192 328 184 trim-warning 0;
#X floatatom 202 21 8 0 0 0 - #0-trimmed-size -;
#X text 260 23 samples.;
#X text 20 22 The trimmed IR size will be:;
#X text 19 70 Trimming can not be undone. Do you want to trim?;
#X obj 84 110 bng 50 250 50 0 \$0-trim-yes empty yes 10 25 0 16 -203904
-262144 -1;
#X obj 173 110 bng 50 250 50 0 \$0-trim-no empty no 14 25 0 16 -203904
-262144 -1;
#X restore 370 89 pd trim-warning;
#X obj 370 20 r \$0-trim-warning;
#X msg 370 48 \; pd-trim-warning vis 1;
#X obj 202 24 r \$0-trim-yes;
#X msg 535 100 \; pd-trim-warning vis 0;
#X obj 535 20 r \$0-trim-yes;
#X obj 550 50 r \$0-trim-no;
#X connect 2 0 0 0;
#X connect 2 0 5 0;
#X connect 3 0 1 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 4 0 11 0;
#X connect 5 0 4 0;
#X connect 5 1 4 1;
#X connect 7 0 8 0;
#X connect 9 0 14 0;
#X connect 9 1 20 0;
#X connect 9 1 26 0;
#X connect 9 1 27 0;
#X connect 10 0 9 1;
#X connect 12 0 10 0;
#X connect 13 0 15 0;
#X connect 14 0 16 0;
#X connect 14 1 15 1;
#X connect 16 0 13 0;
#X connect 17 0 16 1;
#X connect 18 0 20 1;
#X connect 19 0 21 0;
#X connect 20 0 19 0;
#X connect 20 0 22 0;
#X connect 20 0 24 0;
#X connect 26 0 25 0;
#X connect 27 0 23 0;
#X connect 29 0 30 0;
#X connect 31 0 9 0;
#X connect 33 0 32 0;
#X connect 34 0 32 0;
#X restore 661 373 pd cuepoints;
#X floatatom 277 144 13 0 0 0 index #0-index -;
#X floatatom 277 166 13 0 0 0 value #0-value -;
#X obj 397 47 bng 50 250 50 0 \$0-trim-warning empty trim 10 25 0 12
-203904 -262144 -1;
#X floatatom 397 106 8 0 0 0 - #0-trimmed-size -;
#X obj 486 48 bng 50 250 50 0 empty empty window 4 25 0 12 -203904
-262144 -1;
#N canvas 387 196 580 311 window 0;
#X obj 457 233 inlet;
#X msg 457 261 \; pd-window vis 1;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-IR-window 512 float 2;
#X coords 0 1 512 0 512 140 1;
#X restore 20 76 graph;
#X obj 23 36 hsl 507 20 0 1 0 0 \$0-window-slider \$0-window-slider-receive
window-startpoint 40 10 0 10 -262144 -260097 -1 0 0;
#X obj 20 230 tgl 50 1 \$0-double-sided empty empty 17 7 0 10 -203904
-1 -1 0 1;
#N canvas 665 233 440 514 window-shape 0;
#X obj 271 108 pi;
#X obj 271 134 / 2;
#X obj 271 83 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 271 218 *;
#X obj 286 187 t b f;
#X obj 271 321 s \$0-recompute-window;
#X obj 271 271 t b f;
#N canvas 749 286 322 302 window-slider 0;
#X obj 33 215 /;
#X msg 34 193 1;
#X obj 34 172 t b f;
#X obj 33 242 clip 1 100;
#X obj 34 78 abs;
#X msg 34 124 1;
#X obj 34 103 t b f;
#X obj 34 146 -;
#X obj 34 25 r \$0-window-slider;
#X msg 134 203 range 0 1;
#X msg 153 229 range -1 1;
#X obj 134 261 s \$0-window-slider-receive;
#X obj 33 269 outlet;
#X obj 134 112 r \$0-double-sided;
#X obj 134 138 sel 0 1;
#X obj 167 171 loadbang;
#X obj 34 51 speedlim 500;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 2 1 0 1;
#X connect 3 0 12 0;
#X connect 4 0 6 0;
#X connect 5 0 7 0;
#X connect 6 0 5 0;
#X connect 6 1 7 1;
#X connect 7 0 2 0;
#X connect 8 0 16 0;
#X connect 9 0 11 0;
#X connect 10 0 11 0;
#X connect 13 0 14 0;
#X connect 14 0 9 0;
#X connect 14 1 10 0;
#X connect 15 0 9 0;
#X connect 16 0 4 0;
#X restore 286 160 pd window-slider;
#X obj 39 105 for++ 0 511;
#X obj 39 81 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 39 458 pow 1;
#X obj 39 482 tabwrite \$0-IR-window;
#X obj 39 129 t f f;
#X obj 39 14 r \$0-recompute-window;
#X obj 39 365 sin;
#X obj 39 184 abs;
#X obj 39 286 abs;
#X floatatom 211 168 5 0 0 0 - - -;
#X floatatom 65 258 3 0 0 0 - - -;
#X msg 211 116 512;
#X obj 184 13 r \$0-double-sided;
#X obj 211 67 + 1;
#X obj 54 234 r \$0-double-sided;
#X obj 211 139 /;
#X obj 211 91 t b f;
#X obj 66 365 r \$0-window-squared;
#X obj 66 433 + 1;
#X floatatom 80 458 5 0 0 0 - - -;
#X obj 66 388 t b f;
#X obj 66 411 s \$0-recompute-window;
#X obj 184 38 t b f;
#X obj 298 297 s \$0-window-frequency;
#X floatatom 279 245 5 0 0 0 - - -;
#N canvas 0 22 152 167 halfpi 0;
#X obj 26 115 outlet;
#X msg 26 50 1;
#X obj 26 29 loadbang;
#X obj 26 72 asin;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 0 0;
#X restore 114 271 pd halfpi;
#X obj 39 258 - 0;
#X obj 39 156 - 512;
#X obj 53 43 loadbang;
#X obj 39 210 / 512;
#X obj 39 313 * 1.5708;
#X obj 39 338 clip 0 1.5708;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 0 0;
#X connect 3 0 6 0;
#X connect 3 0 32 0;
#X connect 4 0 3 0;
#X connect 4 1 3 1;
#X connect 6 0 5 0;
#X connect 6 1 31 0;
#X connect 6 1 38 1;
#X connect 7 0 4 0;
#X connect 8 0 12 0;
#X connect 9 0 8 0;
#X connect 10 0 11 0;
#X connect 12 0 35 0;
#X connect 12 1 11 1;
#X connect 13 0 9 0;
#X connect 14 0 10 0;
#X connect 15 0 37 0;
#X connect 16 0 38 0;
#X connect 19 0 23 0;
#X connect 20 0 30 0;
#X connect 21 0 24 0;
#X connect 22 0 18 0;
#X connect 22 0 34 1;
#X connect 23 0 17 0;
#X connect 23 0 35 1;
#X connect 23 0 37 1;
#X connect 24 0 19 0;
#X connect 24 1 23 1;
#X connect 25 0 28 0;
#X connect 26 0 10 1;
#X connect 26 0 27 0;
#X connect 28 0 29 0;
#X connect 28 1 26 0;
#X connect 30 0 9 0;
#X connect 30 1 21 0;
#X connect 33 0 38 1;
#X connect 33 0 39 2;
#X connect 34 0 16 0;
#X connect 35 0 15 0;
#X connect 36 0 9 0;
#X connect 37 0 34 0;
#X connect 38 0 39 0;
#X connect 39 0 14 0;
#X restore 349 233 pd window-shape;
#X obj 159 232 tgl 50 0 \$0-window-squared empty empty 17 7 0 10 -203904
-1 -1 0 1;
#X obj 272 233 bng 50 250 50 0 \$0-execute-window empty execute 1 25
0 12 -203904 -262144 -1;
#N canvas 795 124 374 523 execute 0;
#X obj 31 88 for++;
#X obj 31 14 r \$0-execute-window;
#X obj 44 38 r \$0-IRsize;
#X obj 44 63 - 1;
#X obj 31 413 pow 1;
#X obj 31 114 t f f;
#X obj 31 364 sin;
#X obj 31 169 abs;
#X obj 31 265 abs;
#X floatatom 57 243 3 0 0 0 - - -;
#X obj 46 219 r \$0-double-sided;
#X obj 58 364 r \$0-window-squared;
#X obj 58 388 + 1;
#X floatatom 72 413 5 0 0 0 - - -;
#X obj 31 141 -;
#X obj 31 195 /;
#X floatatom 255 153 8 0 0 0 - - -;
#X obj 255 15 r \$0-double-sided;
#X obj 255 42 + 1;
#X obj 255 124 /;
#X obj 255 66 t b f;
#X obj 295 43 r \$0-IRsize;
#X obj 76 265 r \$0-window-frequency;
#X floatatom 84 289 5 0 0 0 - - -;
#X obj 31 492 tabwrite \$0-impulse-response;
#X obj 46 439 tabread \$0-impulse-response;
#X obj 31 466 *;
#N canvas 0 22 152 167 halfpi 0;
#X obj 26 115 outlet;
#X msg 26 50 1;
#X obj 26 29 loadbang;
#X obj 26 72 asin;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 0 0;
#X restore 106 311 pd halfpi;
#X msg 105 105 \; pd-window vis 0;
#X obj 87 145 s \$0-refresh-monitor;
#X obj 295 66 t b f;
#X obj 255 101 f 1;
#X obj 31 243 - 0;
#X obj 31 337 clip 0 1.5708;
#X obj 31 312 * 1.5708;
#X connect 0 0 5 0;
#X connect 0 1 28 0;
#X connect 0 1 29 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 3 0 0 1;
#X connect 4 0 26 0;
#X connect 5 0 14 0;
#X connect 5 1 24 1;
#X connect 5 1 25 0;
#X connect 6 0 4 0;
#X connect 7 0 15 0;
#X connect 8 0 34 0;
#X connect 10 0 9 0;
#X connect 10 0 32 1;
#X connect 11 0 12 0;
#X connect 12 0 4 1;
#X connect 12 0 13 0;
#X connect 14 0 7 0;
#X connect 15 0 32 0;
#X connect 17 0 18 0;
#X connect 18 0 20 0;
#X connect 19 0 16 0;
#X connect 19 0 14 1;
#X connect 19 0 15 1;
#X connect 20 0 31 0;
#X connect 20 1 19 1;
#X connect 21 0 30 0;
#X connect 22 0 23 0;
#X connect 22 0 34 1;
#X connect 25 0 26 1;
#X connect 26 0 24 0;
#X connect 27 0 33 2;
#X connect 30 0 31 0;
#X connect 30 1 31 1;
#X connect 31 0 19 0;
#X connect 32 0 8 0;
#X connect 33 0 6 0;
#X connect 34 0 33 0;
#X restore 349 265 pd execute;
#X text 75 245 double-sided;
#X text 216 247 squared;
#X connect 0 0 1 0;
#X restore 486 106 pd window;
#X obj 574 48 bng 50 250 50 0 empty empty norm 10 25 0 12 -203904 -262144
-1;
#X obj 21 12 cnv 15 244 20 empty empty empty 20 12 0 14 -228856 -66577
0;
#X text 30 14 1: load impulse response;
#X obj 277 12 cnv 15 170 20 empty empty empty 20 12 0 14 -228856 -66577
0;
#X text 283 14 2: set cuepoints \, trim;
#X obj 485 12 cnv 15 65 20 empty empty empty 20 12 0 14 -228856 -66577
0;
#X text 488 14 3: window;
#X obj 573 12 cnv 15 80 20 empty empty empty 20 12 0 14 -228856 -66577
0;
#X text 575 14 4: normalize;
#N canvas 614 93 506 400 norm 0;
#X obj 399 -6 inlet;
#X obj 25 111 bng 50 250 50 0 empty empty 1 17 25 0 25 -203904 -262144
-1;
#X obj 166 209 bng 15 1000 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 25 208 bng 15 1000 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X msg 399 25 \; pd-norm vis 1;
#N canvas 501 22 290 504 small-IR 0;
#X obj 21 12 inlet;
#X obj 38 51 switch~ 131072;
#X obj 21 124 rfft~;
#X obj 21 189 bmax~;
#N canvas 651 584 206 163 pyth~ 0;
#X obj 34 60 *~;
#X obj 34 29 inlet~;
#X obj 96 60 *~;
#X obj 96 29 inlet~;
#X obj 34 97 sqrt~;
#X obj 34 130 outlet~;
#X connect 0 0 4 0;
#X connect 1 0 0 0;
#X connect 1 0 0 1;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 0 2 1;
#X connect 4 0 5 0;
#X restore 21 157 pd pyth~;
#X obj 21 88 tabplay~ \$0-impulse-response;
#X floatatom 59 215 8 0 0 0 - - -;
#X text 112 215 peak index;
#X obj 186 115 s \$0-FFT-done;
#X obj 33 290 s \$0-peak-value;
#X floatatom 43 266 8 0 0 0 - - -;
#X text 95 266 peak value;
#X obj 48 241 s \$0-peak-index;
#X obj 40 424 loadbang;
#X obj 21 475 outlet;
#X obj 21 311 sel 0;
#X obj 21 388 symbol try_again;
#X obj 48 340 bang;
#X obj 40 448 symbol;
#X obj 48 364 symbol done;
#X obj 101 424 r \$0-normalisation-done;
#X connect 0 0 5 0;
#X connect 0 0 1 0;
#X connect 2 0 4 0;
#X connect 2 1 4 1;
#X connect 3 0 9 0;
#X connect 3 0 10 0;
#X connect 3 0 15 0;
#X connect 3 1 6 0;
#X connect 3 1 12 0;
#X connect 4 0 3 0;
#X connect 5 0 2 0;
#X connect 5 1 8 0;
#X connect 13 0 18 0;
#X connect 15 0 16 0;
#X connect 15 1 17 0;
#X connect 16 0 14 0;
#X connect 17 0 19 0;
#X connect 18 0 14 0;
#X connect 19 0 14 0;
#X connect 20 0 18 0;
#X restore 25 233 pd small-IR;
#X floatatom 110 319 8 0 0 0 - - -;
#X floatatom 196 319 8 0 0 0 - - -;
#X obj 312 199 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 312 112 bng 50 250 50 0 empty empty 2 17 25 0 25 -203904 -262144
-1;
#X obj 235 262 bng 15 1000 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#N canvas 0 22 228 299 gate 0;
#X obj 20 25 inlet;
#X obj 63 25 r \$0-peak-value;
#X obj 63 72 sel 0;
#X floatatom 72 49 8 0 0 0 - - -;
#X msg 90 131 1;
#X obj 90 160 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 20 182 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -260097
-1;
#X obj 20 158 spigot;
#X msg 53 131 0;
#X obj 20 261 outlet;
#X obj 90 262 outlet;
#X obj 90 183 sel 0 1;
#X obj 109 209 symbol open;
#X obj 90 239 symbol closed;
#X obj 53 100 loadbang;
#X connect 0 0 7 0;
#X connect 1 0 2 0;
#X connect 1 0 3 0;
#X connect 2 1 4 0;
#X connect 4 0 5 0;
#X connect 4 0 7 1;
#X connect 5 0 11 0;
#X connect 6 0 8 0;
#X connect 6 0 9 0;
#X connect 7 0 6 0;
#X connect 8 0 7 1;
#X connect 8 0 5 0;
#X connect 11 0 13 0;
#X connect 11 1 12 0;
#X connect 12 0 10 0;
#X connect 13 0 10 0;
#X connect 14 0 8 0;
#X restore 312 174 pd gate;
#X text 370 129 execute normalisation;
#N canvas 0 22 395 311 normalisation 0;
#X obj 30 28 inlet;
#X obj 30 251 /;
#X obj 30 132 for++;
#X obj 43 55 r \$0-IRsize;
#X obj 30 274 tabwrite \$0-impulse-response;
#X obj 30 192 tabread \$0-impulse-response;
#X obj 43 109 - 1;
#X floatatom 57 251 8 0 0 0 - - -;
#X obj 30 162 t f f;
#X obj 45 225 r \$0-peak-value;
#X obj 217 149 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X text 236 148 done;
#X floatatom 55 84 8 0 0 0 - - -;
#X obj 217 274 outlet;
#X obj 239 177 s \$0-refresh-monitor;
#X obj 232 211 s \$0-normalisation-done;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 8 0;
#X connect 2 1 10 0;
#X connect 3 0 6 0;
#X connect 3 0 12 0;
#X connect 5 0 1 0;
#X connect 6 0 2 1;
#X connect 8 0 5 0;
#X connect 8 1 4 1;
#X connect 9 0 1 1;
#X connect 9 0 7 0;
#X connect 10 0 13 0;
#X connect 10 0 14 0;
#X connect 10 0 15 0;
#X restore 312 231 pd normalisation;
#X obj 312 261 bng 50 500 50 0 empty empty empty 17 25 0 25 -203904
-260097 -1;
#X text 372 279 done;
#X text 79 129 find maximum spectrum magnitude;
#X symbolatom 351 199 7 0 0 0 - - -;
#X text 193 336 frequency;
#X text 107 336 magnitude;
#X obj 25 318 bng 50 500 50 0 empty empty empty 17 25 0 25 -203904
-260097 -1;
#N canvas 32 33 257 236 spectrum-magnitude-maximum 0;
#X obj -82 7 r \$0-peak-value;
#X obj 45 6 r \$0-peak-index;
#X obj -82 198 outlet;
#X obj -22 199 outlet;
#X obj 45 197 outlet;
#X obj 60 55 samplerate~;
#X obj 60 29 loadbang;
#X obj 45 171 *;
#X obj 118 31 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 60 140 / 131072;
#X connect 0 0 2 0;
#X connect 0 0 3 0;
#X connect 1 0 7 0;
#X connect 5 0 9 0;
#X connect 6 0 5 0;
#X connect 7 0 4 0;
#X connect 8 0 5 0;
#X connect 9 0 7 1;
#X restore 25 294 pd spectrum-magnitude-maximum;
#X symbolatom 166 261 10 0 0 0 - - -;
#N canvas 305 326 704 391 larger-IR 0;
#X obj 22 15 inlet;
#X msg 61 69 const 0;
#X obj 41 153 switch~ 131072;
#X obj 22 44 t b b b;
#X text 116 71 clear sum buffer;
#X msg 41 125 1;
#X obj 22 187 tabplay~ \$0-impulse-response;
#X obj 61 95 s \$0-magnitude-sum;
#X msg 74 125 0;
#X obj 223 280 tabminmax \$0-magnitude-sum;
#X obj 376 305 unpack;
#X obj 22 222 rfft~;
#N canvas 651 584 206 163 pyth~ 0;
#X obj 34 60 *~;
#X obj 34 29 inlet~;
#X obj 96 60 *~;
#X obj 96 29 inlet~;
#X obj 34 97 sqrt~;
#X obj 34 130 outlet~;
#X connect 0 0 4 0;
#X connect 1 0 0 0;
#X connect 1 0 0 1;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 0 2 1;
#X connect 4 0 5 0;
#X restore 22 256 pd pyth~;
#X obj 37 280 tabreceive~ \$0-magnitude-sum;
#X obj 22 308 +~;
#X obj 189 20 table \$0-magnitude-sum 65538;
#X obj 22 336 tabsend~ \$0-magnitude-sum;
#X obj 223 238 delay 20;
#X obj 234 260 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 376 355 s \$0-peak-value;
#X obj 637 284 bang~;
#X obj 637 322 bng 15 500 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 409 330 s \$0-peak-index;
#X obj 534 355 outlet;
#X obj 544 324 symbol done;
#X obj 637 354 outlet;
#X obj 534 221 bng 15 500 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 534 247 symbol patience..;
#X obj 503 136 r \$0-normalisation-done;
#X obj 503 184 symbol;
#X obj 481 137 bng 15 500 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X obj 516 161 loadbang;
#X connect 0 0 3 0;
#X connect 1 0 7 0;
#X connect 3 0 6 0;
#X connect 3 1 5 0;
#X connect 3 2 1 0;
#X connect 3 2 21 0;
#X connect 3 2 27 0;
#X connect 5 0 2 0;
#X connect 6 0 11 0;
#X connect 6 1 8 0;
#X connect 6 1 17 0;
#X connect 6 1 24 0;
#X connect 8 0 2 0;
#X connect 9 1 10 0;
#X connect 10 0 19 0;
#X connect 10 1 22 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 14 0;
#X connect 13 0 14 1;
#X connect 14 0 16 0;
#X connect 17 0 9 0;
#X connect 18 0 9 0;
#X connect 20 0 21 0;
#X connect 21 0 25 0;
#X connect 24 0 23 0;
#X connect 26 0 27 0;
#X connect 27 0 23 0;
#X connect 28 0 29 0;
#X connect 29 0 23 0;
#X connect 30 0 29 0;
#X connect 31 0 29 0;
#X restore 166 234 pd larger-IR;
#N canvas 0 22 404 329 impulse-response-size 0;
#X obj 39 25 inlet;
#X obj 39 109 <= 131072;
#X obj 39 82 f;
#X obj 58 158 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -260097
-1;
#X obj 39 158 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -260097
-1;
#X floatatom 68 83 8 0 0 0 - - -;
#X obj 54 56 r \$0-IRsize;
#X obj 39 135 sel 1 0;
#X obj 39 186 outlet;
#X obj 86 186 outlet;
#X text 38 217 To find the spectrum magnitude maximum \, the largest
possible FFT size in Pd is used (131072 points) \, no matter what impulse
response size. Smaller IR sizes are zero-padded. Spectral resolution
is thus optimized for all IR sizes. For IR's larger than 131072 samples
\, several frames must be accumulated \, therefore the routines for
small and large IR are different.;
#X connect 0 0 2 0;
#X connect 1 0 7 0;
#X connect 2 0 1 0;
#X connect 3 0 9 0;
#X connect 4 0 8 0;
#X connect 6 0 2 1;
#X connect 6 0 5 0;
#X connect 7 0 4 0;
#X connect 7 1 3 0;
#X restore 25 182 pd impulse-response-size;
#X text 24 1 Spectrum magnitude peak normalisation to 0 dBFS (dB Full
Scale). This is equivalent to ~0.707 RMS / -3 dB for a pure sine-wave
\, and 1 RMS / 0 dB for a square wave. Full scale is -1 to 1 in the
32 bit floating point format used for signals in Pd.;
#X symbolatom 25 258 10 0 0 0 - - -;
#X text 18 79 (realtime computation \, may take some time for longer
IR's));
#X connect 0 0 4 0;
#X connect 1 0 24 0;
#X connect 2 0 23 0;
#X connect 3 0 5 0;
#X connect 5 0 26 0;
#X connect 8 0 13 0;
#X connect 9 0 11 0;
#X connect 11 0 8 0;
#X connect 11 1 17 0;
#X connect 13 0 14 0;
#X connect 21 0 20 0;
#X connect 21 1 6 0;
#X connect 21 2 7 0;
#X connect 23 0 22 0;
#X connect 23 1 10 0;
#X connect 24 0 3 0;
#X connect 24 1 2 0;
#X restore 574 106 pd norm;
#X connect 0 0 17 0;
#X connect 9 0 11 0;
#X connect 10 0 14 0;
#X connect 31 0 32 0;
#X connect 33 0 42 0;
